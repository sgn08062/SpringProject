<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.myFarm.stats.StatsMapper">
    <select id="getTotalSales" resultType="StatsVO">
        SELECT SUM(TOTAL_AMOUNT) TOTAL_SALES,
               COUNT(*) TOTAL_ORDERS,
               ROUND(AVG((TOTAL_AMOUNT))) TOTAL_AVG
        FROM ORDERS
        WHERE STATUS IN ('배송 중', '결제 완료');
    </select>

    <select id="getMonthlyStats" resultType="MonthlyStatsVO">
        SELECT
            DATE_FORMAT(ORDER_DATE, '%Y-%m') AS MONTHLY_ORDER,
            COUNT(*) AS MONTHLY_COUNT,
            SUM(TOTAL_AMOUNT) AS MONTHLY_TOTAL,
            ROUND(AVG(TOTAL_AMOUNT)) AS MONTHLY_AVG
        FROM ORDERS
        WHERE STATUS IN ('배송 중', '결제 완료')
        GROUP BY DATE_FORMAT(ORDER_DATE, '%Y-%m')
        ORDER BY MONTHLY_ORDER;
    </select>
</mapper>